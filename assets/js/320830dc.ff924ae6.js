"use strict";(self.webpackChunkscout=self.webpackChunkscout||[]).push([[4266],{9613:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>f});var r=n(9496);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var p=r.createContext({}),l=function(e){var t=r.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=l(e.components);return r.createElement(p.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,p=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=l(n),d=a,f=u["".concat(p,".").concat(d)]||u[d]||m[d]||o;return n?r.createElement(f,i(i({ref:t},c),{},{components:n})):r.createElement(f,i({ref:t},c))}));function f(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=d;var s={};for(var p in t)hasOwnProperty.call(t,p)&&(s[p]=t[p]);s.originalType=e,s[u]="string"==typeof e?e:a,i[1]=s;for(var l=2;l<o;l++)i[l]=n[l];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},7242:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>m,frontMatter:()=>o,metadata:()=>s,toc:()=>l});var r=n(2564),a=(n(9496),n(9613));const o={},i="Unsafe map get",s={unversionedId:"detectors/unsafe-map-get",id:"detectors/unsafe-map-get",title:"Unsafe map get",description:"What it does",source:"@site/docs/detectors/19-unsafe-map-get.md",sourceDirName:"detectors",slug:"/detectors/unsafe-map-get",permalink:"/scout-soroban/docs/detectors/unsafe-map-get",draft:!1,editUrl:"https://github.com/CoinFabrik/scout-soroban/docs/detectors/19-unsafe-map-get.md",tags:[],version:"current",sidebarPosition:19,frontMatter:{},sidebar:"docsSidebar",previous:{title:"Unrestricted Transfer From",permalink:"/scout-soroban/docs/detectors/unrestricted-transfer-from"},next:{title:"Incorrect Exponentiation",permalink:"/scout-soroban/docs/detectors/incorrect-exponentiation"}},p={},l=[{value:"What it does",id:"what-it-does",level:3},{value:"Why is this bad?",id:"why-is-this-bad",level:3},{value:"Example",id:"example",level:3},{value:"Implementation",id:"implementation",level:3}],c={toc:l},u="wrapper";function m(e){let{components:t,...n}=e;return(0,a.kt)(u,(0,r.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"unsafe-map-get"},"Unsafe map get"),(0,a.kt)("h3",{id:"what-it-does"},"What it does"),(0,a.kt)("p",null,"This detector identifies instances where unsafe methods like ",(0,a.kt)("inlineCode",{parentName:"p"},"get"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"get_unchecked"),", and ",(0,a.kt)("inlineCode",{parentName:"p"},"try_get_unchecked")," are used on ",(0,a.kt)("inlineCode",{parentName:"p"},"Map")," objects in Soroban smart contracts."),(0,a.kt)("h3",{id:"why-is-this-bad"},"Why is this bad?"),(0,a.kt)("p",null,"These methods are risky because they can lead to panics if the key does not exist in the map. Using these methods without proper checks increases the risk of runtime errors that can disrupt the execution of the smart contract and potentially lead to unexpected behavior or denial of service."),(0,a.kt)("h3",{id:"example"},"Example"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-rust"},"pub fn get_from_map(env: Env) -> Option<i32> {\n    let map: Map<Val, Val> = map![&env, (1i32.into_val(&env), 2i64.into_val(&env))];\n    let map: Val = map.into();\n    let map: Map<i32, i32> = map.try_into_val(&env).unwrap();\n    map.get(1)\n}\n")),(0,a.kt)("p",null,"Use instead:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-rust"},"pub fn get_map_with_different_values(env: Env, key: i32) -> Result<Option<i32>, Error> {\n    let map: Map<Val, Val> = map![\n        &env,\n        (1i32.into_val(&env), 2i32.into_val(&env)),\n        (3i32.into_val(&env), 4i64.into_val(&env)),\n    ];\n    let map: Val = map.into();\n    let map: Map<i32, i32> = map.try_into_val(&env).unwrap();\n    map.try_get(key).map_err(Error::from)\n}\n")),(0,a.kt)("h3",{id:"implementation"},"Implementation"),(0,a.kt)("p",null,"The detector's implementation can be found at ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/CoinFabrik/scout-soroban/tree/main/detectors/unsafe-map-get"},"this link"),"."))}m.isMDXComponent=!0}}]);